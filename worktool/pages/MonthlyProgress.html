<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>월단위 달성현황</title>

  <!-- 🎨 공통 CSS 파일들 -->
  <link rel="stylesheet" href="../assets/css/variables.css">
  <link rel="stylesheet" href="../assets/css/common.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  
  <!-- 🎨 카드형 디자인 전용 스타일 -->
  <style>
    /* 💎 옵션 1: 카드형 통합 컨트롤러 */
    .card-controller-container {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-4);
      background: var(--white);
      padding: var(--space-5);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      margin-bottom: var(--space-3);
      border: 1px solid var(--gray-200);
    }

    .date-card {
      flex: 1;
      min-width: 140px;
      background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
      color: var(--white);
      padding: var(--space-4);
      border-radius: var(--radius-md);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      position: relative;
      overflow: hidden;
    }

    .date-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(-100%);
      transition: transform var(--transition-normal);
    }

    .date-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px -5px rgba(49, 130, 246, 0.4);
    }

    .date-card:hover::before {
      transform: translateX(0);
    }

    .date-card.active {
      background: linear-gradient(135deg, var(--kakao-yellow), #FFD700);
      color: var(--gray-800);
      box-shadow: 0 4px 12px 0 rgba(254, 229, 0, 0.4);
    }

    .date-card .label {
      font-size: var(--font-size-sm);
      opacity: 0.9;
      margin-bottom: var(--space-1);
      font-weight: var(--font-weight-medium);
    }

    .date-card .value {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      position: relative;
      z-index: 1;
    }

    .date-card .dropdown-icon {
      font-size: var(--font-size-sm);
      margin-top: var(--space-1);
      opacity: 0.8;
    }

    .view-toggle {
      display: flex;
      background: var(--gray-100);
      border-radius: var(--radius-md);
      padding: 4px;
      flex: 1;
      min-width: 280px;
      border: 2px solid var(--gray-200);
    }

    .view-toggle button {
      flex: 1;
      border: none;
      background: transparent;
      padding: var(--space-3) var(--space-4);
      border-radius: var(--radius-sm);
      font-weight: var(--font-weight-semibold);
      font-size: var(--font-size-sm);
      cursor: pointer;
      transition: all var(--transition-normal);
      color: var(--gray-600);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-1);
    }

    .view-toggle button:hover {
      background: rgba(255, 255, 255, 0.5);
      color: var(--gray-800);
    }

    .view-toggle button.active {
      background: var(--white);
      color: var(--primary-blue);
      box-shadow: var(--shadow-sm);
      font-weight: var(--font-weight-bold);
    }

    /* 📊 iframe 스타일 개선 */
    .dataFrame-container {
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      border: 1px solid var(--gray-200);
    }

    iframe {
      width: 107%;
      transform: scale(0.93);
      transform-origin: top left;
      height: calc(100vh - 200px);
    }

    /* 🎨 로딩 애니메이션 개선 */
    .loader {
      border: 4px solid var(--gray-200);
      border-top: 4px solid var(--primary-blue);
      width: 48px;
      height: 48px;
    }

    /* 🎯 모달 스타일 (날짜 선택용) */
    .date-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: var(--z-modal);
      display: none;
      justify-content: center;
      align-items: center;
    }

    .date-modal.show {
      display: flex;
    }

    .modal-content {
      background: var(--white);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-xl);
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .modal-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--space-4);
      color: var(--gray-800);
    }

    .date-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-2);
      margin-bottom: var(--space-4);
    }

    .date-option {
      padding: var(--space-3);
      border: 2px solid var(--gray-200);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--transition-normal);
      font-weight: var(--font-weight-medium);
    }

    .date-option:hover {
      border-color: var(--primary-blue);
      background: var(--gray-50);
    }

    .date-option.selected {
      border-color: var(--primary-blue);
      background: var(--primary-blue);
      color: var(--white);
    }

    .modal-buttons {
      display: flex;
      gap: var(--space-2);
    }

    .modal-button {
      flex: 1;
      padding: var(--space-3) var(--space-4);
      border: none;
      border-radius: var(--radius-md);
      font-weight: var(--font-weight-semibold);
      cursor: pointer;
      transition: all var(--transition-normal);
    }

    .modal-button.cancel {
      background: var(--gray-200);
      color: var(--gray-700);
    }

    .modal-button.cancel:hover {
      background: var(--gray-300);
    }

    .modal-button.confirm {
      background: var(--primary-blue);
      color: var(--white);
    }

    .modal-button.confirm:hover {
      background: var(--primary-blue-light);
    }

    /* 📱 모바일 반응형 */
    @media (max-width: 768px) {
      .card-controller-container {
        flex-direction: column;
        padding: var(--space-4);
        gap: var(--space-3);
      }

      .date-card {
        min-width: 100%;
      }

      .view-toggle {
        min-width: 100%;
      }

      iframe {
        width: 845px;
        transform: scale(0.5);
        height: calc(100vh - 20px);
      }

      .modal-content {
        margin: var(--space-4);
        width: calc(100% - 32px);
      }

      .date-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- 🎨 카드형 통합 컨트롤러 -->
    <div class="card-controller-container">
      <div class="date-card" id="yearCard" data-type="year">
        <div class="label">연도</div>
        <div class="value" id="yearValue">2025년</div>
        <div class="dropdown-icon">▼</div>
      </div>
      
      <div class="date-card" id="monthCard" data-type="month">
        <div class="label">월</div>
        <div class="value" id="monthValue">9월</div>
        <div class="dropdown-icon">▼</div>
      </div>
      
      <div class="view-toggle">
        <button class="active" id="resultButton">
          📊 전지점 현황
        </button>
        <button id="listButton">
          👥 담당자 리스트
        </button>
      </div>
    </div>

    <!-- 데이터 표시 영역 -->
    <div class="dataFrame-container" id="dataFrameContainer">
      <div class="loading-overlay"></div>
      <div class="loader"></div>
      <iframe id="dataFrame" frameborder="0" title="월단위 달성현황 데이터"></iframe>
    </div>
  </div>

  <!-- 🎯 날짜 선택 모달 -->
  <div class="date-modal" id="dateModal">
    <div class="modal-content">
      <h3 class="modal-title" id="modalTitle">연도 선택</h3>
      <div class="date-grid" id="dateGrid">
        <!-- JavaScript로 동적 생성 -->
      </div>
      <div class="modal-buttons">
        <button class="modal-button cancel" id="modalCancel">취소</button>
        <button class="modal-button confirm" id="modalConfirm">확인</button>
      </div>
    </div>
  </div>

  <!-- 🚀 JavaScript -->
  <script src="../assets/js/config.js"></script>
  <script>
    // 📊 데이터 및 상태 관리 (이전과 동일)
    const MONTHLY_DATA = {
      results: {
        "2023-11": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNQn_B_lk_PiYKEn5WCZ2kA7AALZ7Ouw0bPAL-UW0TrSxDLx5-zdXhQQJ5rxnPfiHeO1tA43ZEjnMV/pubhtml?widget=true&headers=false",
        "2023-12": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTeZ8jxr4RtRSZMj4YzXlwryXJENxpGOaok7IkoLNxt75uNSFm8bQK_tM6kKPn8EykrW2uD5TO3riOm/pubhtml?widget=true&amp;headers=false",
        "2024-01": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQFiWu8c_1vmp8IYT23v9TK9XcCi7DKLSbwKrtO2PHEngD9CksrOYsG7CBmWRwNui07n2RBPCVv31z7/pubhtml?widget=true&amp;headers=false",
        "2024-02": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRtkfx7_fASvJvfL_Si3ODhpJIvoLm5ckTNDVg6ffepGkY7UQ1DtZdcYtFgWyojCuT1TXc43cVlQPBN/pubhtml?widget=true&amp;headers=false",
        "2024-03": "https://docs.google.com/spreadsheets/d/e/2PACX-1vS8dyBbA_JVZ34mc6kvjaCvIDfrNQHVmuCfN0RKSQPcz3BHJWXMkEG3gjvIq9CMTMRzum-PH3cSpCCo/pubhtml?widget=true&amp;headers=false",
        "2024-04": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0WcbPejQcndaKdM33432nzOjyMoQgMPBistLrZJepBIpR9hKZNRXwwbTgLvCgPlBXnK5UI6rxF069/pubhtml?widget=true&amp;headers=false",
        "2024-05": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRpsWP3TVevEKXvd9Yk2YOgkmOAH1JMkiLWLTw41CDySeZOUxOG9dmDKmnT76_OIhuWG3wCnGa5wrDc/pubhtml?widget=true&amp;headers=false",
        "2024-06": "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8HmX09f3bj2NMQR1k9WMKAXc2KQcoLMWqDts1yh9RjbOsJg4BctQRvhO9_4DtA1wa-BeZ2CaCKRwR/pubhtml?widget=true&amp;headers=false",
        "2024-07": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRkaMfWCIJaSEgDc8LyWmXJWeYtY5gFNdm56gs9pNLXccwOSfra0pCH0rwHQJgPFZDaqEeZbmNrlvgM/pubhtml?widget=true&amp;headers=false",
        "2024-08": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQH8pCP8F7mG7eDoFqkArPiXG9daFwchRTEAOs5oMLzBgST9P32J1FOYI-17dE5SXbyPOjIYdUkrnqd/pubhtml?widget=true&amp;headers=false",
        "2024-09": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9l8OMZr3B8Zaa-qwAQVMyd4T2_c909BMOsOBu_mTHX1saxwt_5dYVGuUGf5MT9_s-7O3a__EmtMV4/pubhtml?widget=true&amp;headers=false",
        "2024-10": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRKzdYBHhaK20RXCAk9J_o2hjSd4aVx20Ru9GUqNMX0A7iCbS7gRkRtQCiHWi-uQv6ji9K_E3kbPIjc/pubhtml?widget=true&amp;headers=false",
        "2024-11": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTmL9T1aGcJ8-0lXX3BkyHcbT6IWCWRd69t_hndQtnu6UifTaCF-c6lCyUuAQCaEkSO6jJhAritX98-/pubhtml?widget=true&amp;headers=false",
        "2024-12": "https://docs.google.com/spreadsheets/d/e/2PACX-1vR4SqEZqiZYm18FCd2hBJz0A7eWDbANhk9zZmIB3Xtj5iKavgulnn3DlaJDNQ-L64fYEOOaKcvVaK3o/pubhtml?widget=true&amp;headers=false",
        "2025-01": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQqbo988c5qo14CWj026HOP2DhijUKa_ziNhQxVh96M7m5pwVoUDo_qr3F5CGi2Z1szL3eaSWYsmR6C/pubhtml?widget=true&amp;headers=false",
        "2025-02": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTrT0gLp2oQL0v51tr6q5bS6MGpLMjzKtRYSSc9K6cbITsWWUTLtmIkTGJhPrDWZl844moqdnGPSjiB/pubhtml?widget=true&amp;headers=false",
        "2025-03": "https://docs.google.com/spreadsheets/d/e/2PACX-1vT_2xxoxTgNJBXkXNfrOtotOHGpFtDxFRkSA4gaL_OU06AUG-GlOiZVNZsZ8ish-Qb-Mqvox61FpFlN/pubhtml?widget=true&amp;headers=false",
        "2025-04": "https://docs.google.com/spreadsheets/d/e/2PACX-1vT69dPrzPbHjZZ2mCJhlbTgTfZaNvw9eqTx-Wv0ytE7wGym3RSx4MjY15qaPS7EZdMpOeT2RZOCP_f4/pubhtml?widget=true&amp;headers=false",
        "2025-05": "https://docs.google.com/spreadsheets/d/e/2PACX-1vS9pTw9MEjPRPiNmraSGVzeOCwcralP6Sb5hIR5ekT75dmDY3qLHdVaxctdokvDkYZcMFFgM0L5Ojg_/pubhtml?widget=true&amp;headers=false",
        "2025-06": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSNQTW2MvmCMNRh0RlOWqCC63pjDhyF5ouodIwjVV3Lv8qGVkXanoqJeyHE77SEi-gJzYnyE6J5-6JZ/pubhtml?widget=true&amp;headers=false",
        "2025-07": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMVs3mqer4kLeCwD0RWprqxUOsIiNiV2MSIGALgtrL0IW8EK9acCsNIOkBIfFkXfl2dUFM0PvEQ61S/pubhtml?widget=true&amp;headers=false",
        "2025-08": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTIBCfTRJecT3BH_oYQGAcFX87-7MGqSzd0TvCfns4kOg4H4g9cqcu0sFIG6O8YskF1CnNp86dPM_Ee/pubhtml?widget=true&amp;headers=false",
        "2025-09": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQXDXAFhH3oVWXYTBqGsgMqrdag9NYZGfh-hsy9sREn5y0bDrJjLZcwCpXZgGEpBlLUW-Dn4E6jzqQE/pubhtml?widget=true&headers=false"
      },
      lists: {
        "2023-11": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNQn_B_lk_PiYKEn5WCZ2kA7AALZ7Ouw0bPAL-UW0TrSxDLx5-zdXhQQJ5rxnPfiHeO1tA43ZEjnMV/pubhtml?widget=true&headers=false",
        "2023-12": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTeZ8jxr4RtRSZMj4YzXlwryXJENxpGOaok7IkoLNxt75uNSFm8bQK_tM6kKPn8EykrW2uD5TO3riOm/pubhtml?widget=true&amp;headers=false",
        "2024-01": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTqashaYOVtvxxoW4VUcTDBBusFuJt5MQEoBDwKDtNY4nB0aMhidTuPCe0DQLfiHnGpC6yKOasAK5et/pubhtml?widget=true&amp;headers=false",
        "2024-02": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRdLnMAQ3SVR28Lw1BijmxRAIWklHI0CqaojR-fF8NTf1s11Hx6jVv78Fu5pToyV4Eh9o_sf8ZagCfl/pubhtml?widget=true&amp;headers=false",
        "2024-03": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNLwkxx36Naa5LIGBb_dxgAPw7eJ1vE0ov3uBM_LAExB2LebQXN8IuW0tRaXTr2Y5dt7g-fpwlPxzb/pubhtml?widget=true&amp;headers=false",
        "2024-04": "https://docs.google.com/spreadsheets/d/e/2PACX-1vT9RmIw4X58MJZ7LJi7lNLbYauVy4USxKR5hDcBlSRC3PPWk6WQpO7ZNjbRbHagc1Mgv30MufeQniuE/pubhtml?widget=true&amp;headers=false",
        "2024-05": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSaLwv0Bm31IyeIlcTvw6Merbz8X4lkxpZZQZKS3nDjocKt7up7QfgpwZ70d1TSAI9UfHr80fNaOVcp/pubhtml?widget=true&amp;headers=false",
        "2024-06": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRVDkrTCuCKVDfX1mzDMGvskknh-bgec6B5nxy7mERIReNI2XEPt3CfydhebzNvRPNX3jkpy8Slrwy9/pubhtml?widget=true&amp;headers=false",
        "2024-07": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSRWKu1Pg5rPzTl-5CVGbfUSbBXp3M3omIoBU1pEAZlI8rDOHBKqgQV6DAAnI_qWlOiKYRkSKrQ438o/pubhtml?widget=true&amp;headers=false",
        "2024-08": "https://docs.google.com/spreadsheets/d/e/2PACX-1vT0xVObazquQyKhpWKTEnM8t8SyYho-c0EOJp_41A_U9-qN_n0mOhfdQX_4UxhZyXytTkn7KGSjNilc/pubhtml?widget=true&amp;headers=false",
        "2024-09": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTje6Qf_tN9-dy-PliaACnC0NxDVBmy_1XfvBSlpjyCE1Jd_byN5X63de5dlMV82eaIvZ9tZF8HebTB/pubhtml?widget=true&amp;headers=false",
        "2024-10": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSxoGKHP9fpx-UuWEQYA4ULWXu5S7REKPqjpYrfFbu90CyPPOZ-4kAZMIpiam0VhxCUYYLvIo-MI8yW/pubhtml?widget=true&amp;headers=false",
        "2024-11": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSte6F3udcfpgUC5uA06Lc_g_kmYUSw64UbRBHXEF4S3Bm9po1OHEqr8xfXX66NhXMz-yVaXTjVt0nB/pubhtml?widget=true&amp;headers=false",
        "2024-12": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTNkKwrGrydOT0c1Opm8T8XhwhVLPpc2f5cLG9b4yjVFv-5BlgMjQviFFG38PUeLCYXCja6TlMjz45m/pubhtml?widget=true&amp;headers=false",
        "2025-01": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRwj4r-yY3HUpZTpe8uRh4hRTSejR7kf3Jp5ORqhLqqJGclChV42LI8o5o_-oEI_IDuescTCsd4rbn3/pubhtml?widget=true&amp;headers=false",
        "2025-02": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQZpCOUSntOdYEWK0Uf0DnVtd7V03FQa4dqmX9GSdMqbs3YizxGsGvyfpRP-6nN9kuMVcsODTWMK6ri/pubhtml?widget=true&amp;headers=false",
        "2025-03": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRw5QFm9NDjnz2Qsa55gc7onS7hUJYogVsix1OOz5MLf5hzWCtYrkUQyQrKUok4KifdaV6oUxMyT-NT/pubhtml?widget=true&amp;headers=false",
        "2025-04": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSdUPGcQ6umFsboaFmCENwXy5kDSxJU6J7jARdE3xBgd6TyKE_dyLWFlV7xja4FdR_cAd6ZHesk41iH/pubhtml?widget=true&amp;headers=false",
        "2025-05": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQIvOJHkCD0iYxxazgN97Y2rv5RnMkomvifW_jVJlL32126Jozj-TYyLszNHCV9fLupucOPrhymw6on/pubhtml?widget=true&amp;headers=false",
        "2025-06": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTT6p9vAd8NPOoeY1ly-OXKxnF5IPqxuDXSYbjgvEVBz3uXy_wuQgqaM3ElHvw4mZ84EQB84aVAnlH1/pubhtml?widget=true&amp;headers=false",
        "2025-07": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZxvjGKxO91Az7MYzXUIhjlKxVWuz6FQUymxLpsHI_XGTvDMeGnYfB9_voYJtNufPivf-3jFV6pVJC/pubhtml?widget=true&amp;headers=false",
        "2025-08": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7eM6pfw4h2EzcBhThndqFWIT9BV-UNySkeKB4lq5iQb47GyyOeWoW4AHC446tGSGnFoG-9ns7zN-F/pubhtml?widget=true&amp;headers=false",
        "2025-09": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSxBztlSNhUeK2OyfUpwW-44NaWHxKmy0V6lPpFpguPpi1EyJZIBJY8XNxTZoPhZy-v9hHocekqj1k6/pubhtml?widget=true&headers=false"
      }
    };

    // 🎯 상태 변수
    let currentYear = 2025;
    let currentMonth = 9;
    let isListView = false;
    let selectedModalType = null;
    let tempSelectedValue = null;

    // 📱 DOM 요소
    let elements = {};

    // 🚀 초기화
    function initializeElements() {
      elements = {
        yearCard: document.getElementById('yearCard'),
        monthCard: document.getElementById('monthCard'),
        yearValue: document.getElementById('yearValue'),
        monthValue: document.getElementById('monthValue'),
        resultButton: document.getElementById('resultButton'),
        listButton: document.getElementById('listButton'),
        dataFrame: document.getElementById('dataFrame'),
        loader: document.querySelector('.loader'),
        loadingOverlay: document.querySelector('.loading-overlay'),
        
        // 모달 관련
        dateModal: document.getElementById('dateModal'),
        modalTitle: document.getElementById('modalTitle'),
        dateGrid: document.getElementById('dateGrid'),
        modalCancel: document.getElementById('modalCancel'),
        modalConfirm: document.getElementById('modalConfirm')
      };
    }

    // 🔄 로딩 상태 관리
    function showLoading(show = true) {
      elements.loader.style.display = show ? 'block' : 'none';
      elements.loadingOverlay.style.display = show ? 'block' : 'none';
    }

    // 📊 데이터 업데이트
    function updateFrame() {
      const key = `${currentYear}-${String(currentMonth).padStart(2, '0')}`;
      const dataType = isListView ? 'lists' : 'results';
      const url = MONTHLY_DATA[dataType][key];
      
      if (!url) {
        console.warn(`${key}에 해당하는 데이터가 없습니다.`);
        return;
      }

      if (elements.dataFrame.src === url) {
        showLoading(false);
        return;
      }

      showLoading(true);
      elements.dataFrame.onload = () => setTimeout(() => showLoading(false), 300);
      elements.dataFrame.src = url;
    }

    // 🎨 UI 업데이트
    function updateUI() {
      elements.yearValue.textContent = `${currentYear}년`;
      elements.monthValue.textContent = `${currentMonth}월`;
    }

    // 🎯 모달 표시
    function showDateModal(type) {
      selectedModalType = type;
      const isYear = type === 'year';
      
      elements.modalTitle.textContent = isYear ? '연도 선택' : '월 선택';
      
      // 그리드 생성
      elements.dateGrid.innerHTML = '';
      
      if (isYear) {
        // 연도: 2023-2025
        for (let year = 2023; year <= 2025; year++) {
          const option = document.createElement('div');
          option.className = 'date-option';
          option.textContent = `${year}년`;
          option.dataset.value = year;
          if (year === currentYear) option.classList.add('selected');
          elements.dateGrid.appendChild(option);
        }
      } else {
        // 월: 1-12
        for (let month = 1; month <= 12; month++) {
          const option = document.createElement('div');
          option.className = 'date-option';
          option.textContent = `${month}월`;
          option.dataset.value = month;
          if (month === currentMonth) option.classList.add('selected');
          elements.dateGrid.appendChild(option);
        }
      }
      
      elements.dateModal.classList.add('show');
    }

    // 🎯 모달 숨기기
    function hideDateModal() {
      elements.dateModal.classList.remove('show');
      selectedModalType = null;
      tempSelectedValue = null;
    }

    // 🎯 이벤트 핸들러 설정
    function setupEventHandlers() {
      // 카드 클릭 이벤트
      elements.yearCard.addEventListener('click', () => showDateModal('year'));
      elements.monthCard.addEventListener('click', () => showDateModal('month'));
      
      // 뷰 토글 이벤트
      elements.resultButton.addEventListener('click', () => {
        if (isListView) {
          isListView = false;
          elements.resultButton.classList.add('active');
          elements.listButton.classList.remove('active');
          updateFrame();
        }
      });
      
      elements.listButton.addEventListener('click', () => {
        if (!isListView) {
          isListView = true;
          elements.listButton.classList.add('active');
          elements.resultButton.classList.remove('active');
          updateFrame();
        }
      });
      
      // 모달 이벤트
      elements.dateGrid.addEventListener('click', (e) => {
        if (e.target.classList.contains('date-option')) {
          // 기존 선택 제거
          elements.dateGrid.querySelectorAll('.date-option').forEach(opt => 
            opt.classList.remove('selected')
          );
          // 새 선택 추가
          e.target.classList.add('selected');
          tempSelectedValue = parseInt(e.target.dataset.value);
        }
      });
      
      elements.modalCancel.addEventListener('click', hideDateModal);
      
      elements.modalConfirm.addEventListener('click', () => {
        if (tempSelectedValue !== null) {
          if (selectedModalType === 'year') {
            currentYear = tempSelectedValue;
          } else {
            currentMonth = tempSelectedValue;
          }
          updateUI();
          updateFrame();
        }
        hideDateModal();
      });
      
      // 모달 배경 클릭 시 닫기
      elements.dateModal.addEventListener('click', (e) => {
        if (e.target === elements.dateModal) {
          hideDateModal();
        }
      });
    }

    // 🚀 페이지 초기화
    function initializePage() {
      if (!window.WorktoolConfig) {
        setTimeout(initializePage, 100);
        return;
      }

      try {
        initializeElements();
        setupEventHandlers();
        updateUI();
        updateFrame();
        
        console.log('🎨 월간현황 페이지 (카드형 디자인) 로드 완료!');
      } catch (error) {
        console.error('페이지 초기화 오류:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', initializePage);
  </script>
</body>
</html>